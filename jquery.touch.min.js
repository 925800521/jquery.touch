/* jquery.touch.js v0.1 | (c) n33 | n33.co | MIT licensed */
(function(g){function d(c,a){this.settings=g.extend(m,a);this.element=c;this.inDrag=this.inTap=!1;this.ey=this.ex=this.y=this.x=this.tapScrollTop=this.timerTapAndHold=this.timerTap=this.dragStart=this.tapStart=null;this.taps=0;this.init()}var l=g(document),m={useTapAndHold:!1,useMouse:!0,dragThreshold:10,dragDelay:100,swipeThreshold:30,tapLimit:2,tapDelay:250,tapAndHoldDelay:1E3};d.prototype.init=function(){var c=this;c.element.on("touchstart",function(a){c.doStart(a,a.originalEvent.touches[0].pageX,
a.originalEvent.touches[0].pageY)}).on("touchmove",function(a){c.doMove(a,a.originalEvent.changedTouches[0].pageX,a.originalEvent.changedTouches[0].pageY)}).on("touchend",function(a){c.doEnd(a,a.originalEvent.changedTouches[0].pageX,a.originalEvent.changedTouches[0].pageY)});c.settings.useMouse&&(c.mouseDown=!1,c.element.on("mousedown",function(a){c.mouseDown=!0;c.doStart(a,a.pageX,a.pageY)}).on("mousemove",function(a){c.mouseDown&&c.doMove(a,a.pageX,a.pageY)}).on("mouseup mouseleave",function(a){c.mouseDown=
!1;c.doEnd(a,a.pageX,a.pageY)}))};d.prototype.scrolled=function(){return this.tapScrollTop!=l.scrollTop()};d.prototype.cancel=function(){this.taps=0;this.inDrag=this.inTap=!1;this.dragStart=this.tapStart=null};d.prototype.doStart=function(c,a,e){var b=this,f=b.element.offset();b.x=a;b.y=e;b.ex=a-f.left;b.ey=e-f.top;b.tapStart=Date.now();b.tapScrollTop=l.scrollTop();window.clearTimeout(b.timerTap);b.timerTap=window.setTimeout(function(){b.inTap&&0<b.taps&&(c.preventDefault(),b.element.trigger(2==b.taps?
"doubleTap":"tap",{taps:b.taps,x:b.x,y:b.y,ex:b.ex,ey:b.ey,duration:Date.now()-b.tapStart}),b.cancel());b.timerTap=null},b.settings.tapDelay);window.clearTimeout(b.timerTapAndHold);b.timerTapAndHold=window.setTimeout(function(){b.settings.useTapAndHold&&b.inTap&&(c.preventDefault(),b.element.trigger("tapAndHold",{x:b.x,y:b.y,ex:b.ex,ey:b.ey,duration:Date.now()-b.tapStart}),b.cancel());b.timerTapAndHold=null},b.settings.tapAndHoldDelay);b.inTap=!0};d.prototype.doMove=function(c,a,e){var b=this.element.offset(),
f=(Math.abs(this.x-a)+Math.abs(this.y-e))/2;this.scrolled()?this.cancel():this.inDrag?(c.preventDefault(),this.element.trigger("drag",{x:a,y:e,ex:a-b.left,ey:e-b.top})):f>this.settings.dragThreshold&&(Date.now()-this.tapStart<this.settings.dragDelay?this.cancel():(this.cancel(),this.inDrag=!0,this.dragStart=Date.now(),c.preventDefault(),this.element.trigger("dragStart",{x:a,y:e,ex:a-b.left,ey:e-b.top})))};d.prototype.doEnd=function(c,a,e){var b=this.element.offset(),f=Math.abs(this.x-a),d=Math.abs(this.y-
e),g,k,h;if(this.scrolled())this.cancel();else if(this.inTap){if(this.taps++,!this.timerTap||this.taps>=this.settings.tapLimit)c.preventDefault(),this.element.trigger(2==this.taps?"doubleTap":"tap",{taps:this.taps,x:this.x,y:this.y,ex:this.ex,ey:this.ey,duration:Date.now()-this.tapStart}),this.cancel()}else if(this.inDrag){h=Date.now()-this.dragStart;g=Math.sqrt(Math.pow(Math.abs(this.x-a),2)+Math.pow(Math.abs(this.y-e),2));k=g/h;c.preventDefault();this.element.trigger("dragEnd",{start:{x:this.x,
y:this.y,ex:this.ex,ey:this.ey},end:{x:a,y:e,ex:a-b.left,ey:e-b.top},distance:g,duration:h,velocity:k});if(f>this.settings.swipeThreshold||d>this.settings.swipeThreshold)c.preventDefault(),this.element.trigger("swipe",{distance:g,duration:h,velocity:k}),f>d?(k=f/h,a<this.x?this.element.trigger("swipeLeft",{distance:f,duration:h,velocity:k}):this.element.trigger("swipeRight",{distance:f,duration:h,velocity:k})):d>f&&(k=d/h,e<this.y?this.element.trigger("swipeUp",{distance:d,duration:h,velocity:k}):
this.element.trigger("swipeDown",{distance:d,duration:h,velocity:k}));this.inDrag=!1}};g.fn.enableTouch=function(c){if(1<this.length)for(var a=0;a<this.length;a++)g(this[a]).enableTouch();a=g(this);new d(a,c);return a}})(jQuery);
